{% extends "base.html" %}
{% block title %}QR Code Generated{% endblock %}
{% block content %}
<div class="card mx-auto" style="max-width: 500px;" data-aos="fade-up">
    <div class="card-body text-center">
        <h1 class="mb-4"><i class="fas fa-qrcode me-2"></i>QR Code Generated</h1>
        <p>Your health card has been created! Scan the QR code below to access your emergency health information.</p>
        <img src="data:image/png;base64,{{ qr_base64 }}" alt="QR Code" class="img-fluid mb-3" style="max-width: 300px;">
        <p><strong>User ID:</strong> {{ user_id }}</p>
        <div class="d-flex justify-content-center gap-3">
            <button onclick="window.print()" class="btn btn-primary"><i class="fas fa-print me-2"></i>Print QR Code</button>
            <a href="#" onclick="downloadQRCode('{{ qr_base64 }}', '{{ user_id }}')" class="btn btn-success"><i class="fas fa-download me-2"></i>Download QR Code</a>
        </div>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<script>
    AOS.init({
        duration: 1000,
        once: true
    });

    function downloadQRCode(qrBase64, userId) {
        const qrDataUrl = `data:image/png;base64,${qrBase64}`;
        const a = document.createElement('a');
        a.href = qrDataUrl;
        a.download = `qr_code_${userId}.png`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }
</script>
{% endblock %}